version: v1.0
name: Initial Pipeline
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: 'Block #1'
    task:
      jobs:
        - name: Job checkout
          commands:
            - checkout
            - echo "Update"
            - 'sudo apt-get update -y  '
            - echo "Upgrade"
            - >-
              sudo apt-get upgrade -y --force-yes -o
              Dpkg::Options::="--force-confnew"
            - '#echo "Dist-upgrade"'
            - '#sudo apt-get dist-upgrade -y'
            - sudo apt-get install build-essential software-properties-common -y
            - 'sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y'
            - sudo apt-get update -y
            - echo "Installing gcc 9"
            - sudo apt-get install gcc-9 g++-9 -y
            - echo "Updating alternatives - install"
            - >-
              sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-9
              60 --slave /usr/bin/g++ g++ /usr/bin/g++-9
            - echo "Updating alternatives - set g++"
            - sudo update-alternatives --auto --set g++ "/usr/bin/g++-9"
            - echo "Updating alternatives - set gcc"
            - sudo update-alternatives --auto --set gcc "/usr/bin/gcc-9"
            - sudo apt install bison -y
            - sudo apt install flex -y
            - cd ./catmint-lex
            - make
            - ./qtest.sh
